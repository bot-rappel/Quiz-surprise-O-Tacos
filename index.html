<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz O'Tacos - Groupe AMAUH</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: linear-gradient(135deg, #f97316 0%, #dc2626 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .card { background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); padding: 30px; margin-bottom: 20px; }
        h1 { color: #f97316; font-size: 2.5em; text-align: center; margin-bottom: 10px; }
        h2 { color: #1f2937; font-size: 1.8em; margin-bottom: 20px; }
        h3 { color: #374151; font-size: 1.3em; margin-bottom: 15px; }
        .subtitle { text-align: center; color: #6b7280; margin-bottom: 30px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: 600; color: #374151; margin-bottom: 8px; font-size: 0.9em; }
        input, select { width: 100%; padding: 12px; border: 2px solid #d1d5db; border-radius: 8px; font-size: 1em; }
        input:focus, select:focus { outline: none; border-color: #f97316; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn-primary { background: linear-gradient(135deg, #f97316, #dc2626); color: white; width: 100%; padding: 16px; font-size: 1.1em; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(249, 115, 22, 0.4); }
        .btn-secondary { background: #6b7280; color: white; }
        .btn-secondary:hover { background: #4b5563; }
        .btn-success { background: #10b981; color: white; }
        .btn-danger { background: #ef4444; color: white; }
        .btn-small { padding: 8px 16px; font-size: 0.9em; }
        .quiz-size { background: #fff7ed; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .size-options { display: flex; gap: 12px; flex-wrap: wrap; }
        .size-btn { padding: 12px 24px; border: 2px solid #fed7aa; background: white; color: #9a3412; border-radius: 8px; font-weight: 600; cursor: pointer; }
        .size-btn.active { background: #f97316; color: white; border-color: #f97316; }
        .option-btn { width: 100%; text-align: left; padding: 16px; margin-bottom: 12px; border: 2px solid #e5e7eb; background: white; border-radius: 8px; font-size: 1em; cursor: pointer; transition: all 0.2s; }
        .option-btn:hover { border-color: #f97316; background: #fff7ed; }
        .option-letter { display: inline-block; width: 32px; height: 32px; background: #fff7ed; color: #f97316; border-radius: 50%; text-align: center; line-height: 32px; font-weight: bold; margin-right: 12px; }
        .progress-bar { width: 100%; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden; margin-bottom: 20px; }
        .progress-fill { height: 100%; background: #f97316; transition: width 0.3s; }
        .result-card { border-left: 4px solid #10b981; padding: 16px; margin-bottom: 12px; border-radius: 8px; }
        .result-card.wrong { border-left-color: #ef4444; background: #fef2f2; }
        .result-card.correct { background: #f0fdf4; }
        .score-display { background: linear-gradient(135deg, #f97316, #dc2626); color: white; padding: 40px; border-radius: 12px; text-align: center; margin-bottom: 30px; }
        .score-number { font-size: 4em; font-weight: bold; margin-bottom: 10px; }
        .icon-card { text-align: center; padding: 30px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s; }
        .icon-card:hover { transform: translateY(-5px); box-shadow: 0 5px 20px rgba(0,0,0,0.15); }
        .icon { font-size: 3em; margin-bottom: 10px; }
        .hidden { display: none; }
        .question-list { max-height: 400px; overflow-y: auto; }
        .question-item { border: 1px solid #e5e7eb; padding: 16px; border-radius: 8px; margin-bottom: 12px; }
        .flex-between { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        .text-success { color: #10b981; font-weight: 600; }
        .text-small { font-size: 0.9em; color: #6b7280; }
        @media (max-width: 768px) { h1 { font-size: 2em; } .size-options { flex-direction: column; } }
    </style>
</head>
<body>
    <div class="container" id="app"></div>

    <script>
        const questions = [
            { question: "Quelle est la temp√©rature minimale requise pour le lavage des mains ?", options: ["38¬∞C", "25¬∞C", "42¬∞C", "50¬∞C"], answer: "38¬∞C" },
            { question: "Qu'est-ce qui est strictement interdit en cuisine ?", options: ["Torchons et √©ponges", "Ustensiles en plastique", "Serviettes en papier", "Crayons alimentaires"], answer: "Torchons et √©ponges" },
            { question: "Quelle est la taille maximale du O'tacos ?", options: ["M", "L", "XL", "Gigatacos"], answer: "Gigatacos" },
            { question: "Taux de compos√©s polaires maximum dans l'huile ?", options: ["23%", "14%", "10%", "30%"], answer: "23%" },
            { question: "Contr√¥le temp√©rature chambres froides par jour ?", options: ["Une fois", "Deux fois", "Trois fois", "Toutes les heures"], answer: "Deux fois" },
            { question: "Temps maximum conservation produit d√©congel√© ?", options: ["24 heures", "48 heures", "72 heures", "96 heures"], answer: "72 heures" },
            { question: "Ingr√©dient unique dans les O'tacos ?", options: ["Sauce barbecue", "Sauce fromag√®re", "Moutarde", "Sauce ketchup"], answer: "Sauce fromag√®re" },
            { question: "D√©lai maximal entre commande et livraison ?", options: ["2 minutes", "4 minutes", "6 minutes", "8 minutes"], answer: "4 minutes" },
            { question: "Comment √©tiqueter apr√®s d√©cong√©lation ?", options: ["Date √©tiquetage", "Date limite uniquement", "Date et heure d√©cong√©lation et fin", "Nom produit uniquement"], answer: "Date et heure d√©cong√©lation et fin" },
            { question: "Combien de types de fromages propos√©s ?", options: ["2", "3", "4", "5"], answer: "4" },
            { question: "Ustensile obligatoire pour couper XXL ?", options: ["Couteau plastique", "Couteau c√©ramique", "Couteau m√©tal", "Ciseaux"], answer: "Couteau m√©tal" },
            { question: "Temps maximum cuisson steak hach√© ?", options: ["2 minutes", "3 minutes", "4 minutes", "5 minutes"], answer: "4 minutes" },
            { question: "Fr√©quence nettoyage grill et friteuses ?", options: ["Tous les jours", "Toutes les 2h", "Une fois par semaine", "Toutes les 4h"], answer: "Tous les jours" },
            { question: "Stockage sauces ouvertes au frigo ?", options: ["Sans couvercle", "R√©cipient ferm√©", "Emballage origine", "Temp√©rature ambiante"], answer: "R√©cipient ferm√©" },
            { question: "Ingr√©dient principal du tacos v√©g√©tarien ?", options: ["Poulet", "Steak hach√©", "Falafel", "Fromage seul"], answer: "Falafel" },
            { question: "Nombre maximum de sauces dans un tacos ?", options: ["1", "2", "3", "4"], answer: "3" },
            { question: "Signal remplacement huile de friture ?", options: ["Changement couleur", "√âmission odeur", "Mousse excessive", "Toutes ces r√©ponses"], answer: "Toutes ces r√©ponses" },
            { question: "Comment v√©rifier temp√©rature aliments ?", options: ["√Ä l'oeil", "Avec thermom√®tre", "Au toucher", "Avec timer"], answer: "Avec thermom√®tre" },
            { question: "Type de gants pour aliments chauds ?", options: ["Gants latex", "Gants r√©sistants chaleur", "Gants coton", "Pas de gants"], answer: "Gants r√©sistants chaleur" },
            { question: "Fr√©quence vidage poubelles cuisine ?", options: ["Une fois par jour", "D√®s qu'elles sont pleines", "Toutes les 2h", "Toutes les 4h"], answer: "D√®s qu'elles sont pleines" },
            { question: "Disposition aliments dans frigo ?", options: ["Tout m√©lang√©", "Crus au-dessus cuits", "Crus en dessous cuits", "Pas importance"], answer: "Crus en dessous cuits" },
            { question: "D√©lai maximal pr√©paration vente garniture chaude ?", options: ["1 heure", "2 heures", "3 heures", "4 heures"], answer: "2 heures" },
            { question: "Type nettoyage obligatoire apr√®s service ?", options: ["Nettoyage humide", "Nettoyage sec", "D√©sinfection compl√®te", "Rin√ßage rapide"], answer: "D√©sinfection compl√®te" },
            { question: "R√¥le principal du manager en cuisine ?", options: ["Cuisiner uniquement", "Contr√¥ler stocks et propret√©", "Servir clients", "Comptabilit√©"], answer: "Contr√¥ler stocks et propret√©" },
            { question: "Produit √† ne jamais recongeler ?", options: ["L√©gumes", "Steak hach√©", "Pain", "Fromage"], answer: "Steak hach√©" },
            { question: "Gestion r√©clamations clients ?", options: ["Ignorer", "Noter et informer manager", "R√©pondre agressivement", "Donner bon achat"], answer: "Noter et informer manager" },
            { question: "Quand porter uniforme propre ?", options: ["Seulement matin", "Pendant tout service", "Seulement inspections", "Uniquement livraison"], answer: "Pendant tout service" },
            { question: "D√©lai servir boisson fra√Æche ?", options: ["1 minute", "2 minutes", "5 minutes", "10 minutes"], answer: "2 minutes" },
            { question: "Stockage viandes crues ?", options: ["Bacs s√©par√©s", "Directement √©tag√®re", "Avec produits cuits", "√Ä c√¥t√© sauces"], answer: "Bacs s√©par√©s" }
        ];

        const restaurants = ['Louvain-La-Neuve', 'Auderghem', 'Uccle', 'Halle', 'Soignies', 'Ath', 'Renaix', 'Mouscron'];

        let state = {
            view: 'home',
            employeeName: '',
            restaurant: '',
            quizSize: 10,
            currentQuiz: [],
            currentQuestion: 0,
            answers: [],
            history: JSON.parse(localStorage.getItem('otacos-history') || '[]')
        };

        function render() {
            const app = document.getElementById('app');
            if (state.view === 'home') app.innerHTML = renderHome();
            else if (state.view === 'quiz') app.innerHTML = renderQuiz();
            else if (state.view === 'results') app.innerHTML = renderResults();
            else if (state.view === 'history') app.innerHTML = renderHistory();
        }

        function renderHome() {
            return `
                <div class="card">
                    <h1>üåÆ Quiz O'Tacos</h1>
                    <p class="subtitle">Groupe AMAUH - Contr√¥le des connaissances terrain</p>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Nom de l'√©quipier</label>
                            <input type="text" id="employeeName" placeholder="Pr√©nom Nom" value="${state.employeeName}">
                        </div>
                        <div class="form-group">
                            <label>Restaurant</label>
                            <select id="restaurant">
                                <option value="">S√©lectionner...</option>
                                ${restaurants.map(r => `<option value="${r}" ${state.restaurant === r ? 'selected' : ''}>${r}</option>`).join('')}
                            </select>
                        </div>
                    </div>

                    <div class="quiz-size">
                        <label>Nombre de questions pour le quiz</label>
                        <div class="size-options">
                            ${[5, 10, 15, 20].map(size => `
                                <button class="size-btn ${state.quizSize === size ? 'active' : ''}" onclick="setQuizSize(${size})">${size}</button>
                            `).join('')}
                        </div>
                        <p class="text-small" style="margin-top: 10px;">Banque actuelle : ${questions.length} questions</p>
                    </div>

                    <button class="btn btn-primary" onclick="startQuiz()">üé≤ G√©n√©rer un Quiz Al√©atoire</button>
                </div>

                <div class="grid">
                    <div class="icon-card" onclick="state.view='history'; render();">
                        <div class="icon">üìä</div>
                        <h3>Historique</h3>
                        <p class="text-small">${state.history.length} quiz r√©alis√©s</p>
                    </div>
                    <div class="icon-card" onclick="exportData()">
                        <div class="icon">üíæ</div>
                        <h3>Sauvegarder</h3>
                        <p class="text-small">Export JSON</p>
                    </div>
                </div>
            `;
        }

        function renderQuiz() {
            const q = state.currentQuiz[state.currentQuestion];
            const progress = ((state.currentQuestion + 1) / state.currentQuiz.length) * 100;
            
            return `
                <div class="card">
                    <div class="flex-between" style="margin-bottom: 15px;">
                        <span style="font-weight: 600; color: #6b7280;">Question ${state.currentQuestion + 1} / ${state.currentQuiz.length}</span>
                        <span style="font-weight: 600; color: #f97316;">${state.employeeName}</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                    
                    <h2>${q.question}</h2>
                    
                    <div>
                        ${q.options.map((opt, idx) => `
                            <button class="option-btn" onclick="answerQuestion('${opt.replace(/'/g, "\\'")}')">
                                <span class="option-letter">${String.fromCharCode(65 + idx)}</span>
                                ${opt}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderResults() {
            const r = state.results;
            const icon = r.percentage >= 80 ? '‚úÖ' : r.percentage >= 60 ? '‚ö†Ô∏è' : '‚ùå';
            
            return `
                <div class="card">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <div style="font-size: 5em; margin-bottom: 20px;">${icon}</div>
                        <h1 style="margin-bottom: 10px;">R√©sultats du Quiz</h1>
                        <p style="color: #6b7280; font-size: 1.1em;">${r.employeeName} - ${r.restaurant}</p>
                        <p class="text-small">${r.date}</p>
                    </div>

                    <div class="score-display">
                        <div class="score-number">${r.percentage}%</div>
                        <div style="font-size: 1.3em;">${r.score} / ${r.total} bonnes r√©ponses</div>
                    </div>

                    <div style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                        ${r.details.map(d => `
                            <div class="result-card ${d.isCorrect ? 'correct' : 'wrong'}">
                                <div style="display: flex; gap: 15px;">
                                    <div style="font-size: 1.5em;">${d.isCorrect ? '‚úÖ' : '‚ùå'}</div>
                                    <div style="flex: 1;">
                                        <p style="font-weight: 600; margin-bottom: 8px;">${d.question}</p>
                                        <p class="text-small">R√©ponse donn√©e : ${d.userAnswer}</p>
                                        ${!d.isCorrect ? `<p class="text-success" style="margin-top: 5px;">Bonne r√©ponse : ${d.correctAnswer}</p>` : ''}
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="grid">
                        <button class="btn btn-primary" onclick="resetQuiz()">Nouveau Quiz</button>
                        <button class="btn btn-secondary" onclick="state.view='history'; render();">Voir l'Historique</button>
                    </div>
                </div>
            `;
        }

        function renderHistory() {
            return `
                <div class="card">
                    <div class="flex-between" style="margin-bottom: 20px;">
                        <h2>Historique des Quiz (${state.history.length})</h2>
                        <button class="btn btn-secondary btn-small" onclick="state.view='home'; render();">Retour</button>
                    </div>

                    ${state.history.length === 0 ? 
                        '<p style="text-align: center; color: #6b7280; padding: 40px;">Aucun quiz r√©alis√© pour le moment</p>' :
                        state.history.map(h => `
                            <div class="question-item">
                                <div class="flex-between">
                                    <div>
                                        <h3>${h.employeeName}</h3>
                                        <p class="text-small">${h.restaurant} - ${h.date}</p>
                                        <p class="text-small" style="margin-top: 5px;">${h.score} / ${h.total} r√©ponses correctes</p>
                                    </div>
                                    <div style="font-size: 2em; font-weight: bold; color: ${h.percentage >= 80 ? '#10b981' : h.percentage >= 60 ? '#f59e0b' : '#ef4444'};">
                                        ${h.percentage}%
                                    </div>
                                </div>
                            </div>
                        `).join('')
                    }
                </div>
            `;
        }

        function setQuizSize(size) {
            state.quizSize = size;
            render();
        }

        function startQuiz() {
            state.employeeName = document.getElementById('employeeName').value;
            state.restaurant = document.getElementById('restaurant').value;

            if (!state.employeeName || !state.restaurant) {
                alert('Veuillez renseigner le nom et le restaurant');
                return;
            }

            const shuffled = [...questions].sort(() => Math.random() - 0.5);
            state.currentQuiz = shuffled.slice(0, state.quizSize);
            state.currentQuestion = 0;
            state.answers = [];
            state.view = 'quiz';
            render();
        }

        function answerQuestion(answer) {
            state.answers.push(answer);
            
            if (state.currentQuestion < state.currentQuiz.length - 1) {
                state.currentQuestion++;
                render();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            const score = state.answers.filter((ans, idx) => ans === state.currentQuiz[idx].answer).length;
            const percentage = Math.round((score / state.currentQuiz.length) * 100);
            
            state.results = {
                employeeName: state.employeeName,
                restaurant: state.restaurant,
                date: new Date().toLocaleString('fr-BE'),
                score,
                total: state.currentQuiz.length,
                percentage,
                details: state.currentQuiz.map((q, idx) => ({
                    question: q.question,
                    userAnswer: state.answers[idx],
                    correctAnswer: q.answer,
                    isCorrect: state.answers[idx] === q.answer
                }))
            };
            
            state.history.unshift(state.results);
            localStorage.setItem('otacos-history', JSON.stringify(state.history));
            state.view = 'results';
            render();
        }

        function resetQuiz() {
            state.view = 'home';
            state.employeeName = '';
            state.restaurant = '';
            render();
        }

        function exportData() {
            const data = { questions, history: state.history };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'otacos-quiz-backup.json';
            a.click();
        }

        render();
    </script>
</body>
</html>
