<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz O'Tacos - Groupe AMAUH</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: linear-gradient(135deg, #f97316 0%, #dc2626 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .card { background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); padding: 30px; margin-bottom: 20px; }
        h1 { color: #f97316; font-size: 2.5em; text-align: center; margin-bottom: 10px; }
        h2 { color: #1f2937; font-size: 1.8em; margin-bottom: 20px; }
        h3 { color: #374151; font-size: 1.3em; margin-bottom: 15px; }
        .subtitle { text-align: center; color: #6b7280; margin-bottom: 30px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: 600; color: #374151; margin-bottom: 8px; font-size: 0.9em; }
        input, select { width: 100%; padding: 12px; border: 2px solid #d1d5db; border-radius: 8px; font-size: 1em; }
        input:focus, select:focus { outline: none; border-color: #f97316; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn-primary { background: linear-gradient(135deg, #f97316, #dc2626); color: white; width: 100%; padding: 16px; font-size: 1.1em; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(249, 115, 22, 0.4); }
        .btn-secondary { background: #6b7280; color: white; }
        .btn-secondary:hover { background: #4b5563; }
        .btn-small { padding: 8px 16px; font-size: 0.9em; }
        .quiz-size { background: #fff7ed; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .size-options { display: flex; gap: 12px; flex-wrap: wrap; }
        .size-btn { padding: 12px 24px; border: 2px solid #fed7aa; background: white; color: #9a3412; border-radius: 8px; font-weight: 600; cursor: pointer; }
        .size-btn.active { background: #f97316; color: white; border-color: #f97316; }
        .option-btn { width: 100%; text-align: left; padding: 16px; margin-bottom: 12px; border: 2px solid #e5e7eb; background: white; border-radius: 8px; font-size: 1em; cursor: pointer; transition: all 0.2s; }
        .option-btn:hover { border-color: #f97316; background: #fff7ed; }
        .option-letter { display: inline-block; width: 32px; height: 32px; background: #fff7ed; color: #f97316; border-radius: 50%; text-align: center; line-height: 32px; font-weight: bold; margin-right: 12px; }
        .progress-bar { width: 100%; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden; margin-bottom: 20px; }
        .progress-fill { height: 100%; background: #f97316; transition: width 0.3s; }
        .result-card { border-left: 4px solid #10b981; padding: 16px; margin-bottom: 12px; border-radius: 8px; }
        .result-card.wrong { border-left-color: #ef4444; background: #fef2f2; }
        .result-card.correct { background: #f0fdf4; }
        .score-display { background: linear-gradient(135deg, #f97316, #dc2626); color: white; padding: 40px; border-radius: 12px; text-align: center; margin-bottom: 30px; }
        .score-number { font-size: 4em; font-weight: bold; margin-bottom: 10px; }
        .icon-card { text-align: center; padding: 30px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s; }
        .icon-card:hover { transform: translateY(-5px); box-shadow: 0 5px 20px rgba(0,0,0,0.15); }
        .icon { font-size: 3em; margin-bottom: 10px; }
        .hidden { display: none; }
        .question-list { max-height: 400px; overflow-y: auto; }
        .question-item { border: 1px solid #e5e7eb; padding: 16px; border-radius: 8px; margin-bottom: 12px; }
        .flex-between { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        .text-success { color: #10b981; font-weight: 600; }
        .text-small { font-size: 0.9em; color: #6b7280; }
        @media (max-width: 768px) { h1 { font-size: 2em; } .size-options { flex-direction: column; } }
    </style>
</head>
<body>
    <div class="container" id="app"></div>

    <script>
        const questions = [
            { question: "Quelle est la température minimale requise pour le lavage des mains dans un restaurant O'Tacos ?", options: ["38°C", "25°C", "42°C", "50°C"], answer: "38°C" },
            { question: "Qu'est-ce qui est strictement interdit en cuisine selon le manuel de O'Tacos ?", options: ["Torchons et éponges", "Ustensiles en plastique", "Serviettes en papier", "Crayons alimentaires"], answer: "Torchons et éponges" },
            { question: "Quelle est la taille maximale du O'tacos proposée chez O'Tacos ?", options: ["M", "L", "XL", "Gigatacos"], answer: "Gigatacos" },
            { question: "Quel est le taux de composés polaires à ne pas dépasser dans l'huile de friture ?", options: ["23%", "14%", "10%", "30%"], answer: "23%" },
            { question: "Combien de fois par jour doit-on contrôler la température des chambres froides ?", options: ["Une fois par jour", "Deux fois par jour", "Trois fois par jour", "Toutes les heures"], answer: "Deux fois par jour" },
            { question: "Combien de temps maximum un produit décongelé peut-il être conservé au froid positif ?", options: ["24 heures", "48 heures", "72 heures", "96 heures"], answer: "72 heures" },
            { question: "Quel ingrédient est unique dans les O'tacos proposés par O'Tacos ?", options: ["Sauce barbecue", "Sauce fromagère", "Moutarde", "Sauce ketchup"], answer: "Sauce fromagère" },
            { question: "Quel est le délai maximal entre la prise de commande et la livraison d'un O'tacos ?", options: ["2 minutes", "4 minutes", "6 minutes", "8 minutes"], answer: "4 minutes" },
            { question: "Comment les produits doivent-ils être étiquetés après décongélation ?", options: ["Avec la date d'étiquetage", "Avec la date limite uniquement", "Avec date et heure décongélation et fin", "Avec le nom uniquement"], answer: "Avec date et heure décongélation et fin" },
            { question: "Quel appareil est utilisé pour mesurer la qualité de l'huile de friture ?", options: ["Thermomètre à sonde", "Thermo-hygromètre", "Le testo 270", "Tensiomètre"], answer: "Le testo 270" },
            { question: "Quel est l'un des quatre critères fondamentaux pour la satisfaction du client ?", options: ["La rapidité du service", "L'offre de boissons", "La variété des desserts", "L'ambiance musicale"], answer: "La rapidité du service" },
            { question: "Quelle est la température minimale à coeur pour conserver les produits chauds cuits ?", options: ["55°C", "60°C", "65°C", "70°C"], answer: "65°C" },
            { question: "Que doit-on faire en cas de détection de nuisibles ?", options: ["Noter dans cahier", "Contacter société spécialisée", "Fermer 24 heures", "Déplacer produits"], answer: "Contacter société spécialisée" },
            { question: "Quelle est la fréquence recommandée pour le nettoyage des machines à milk-shake ?", options: ["Une fois par semaine", "Deux fois par semaine", "Tous les jours", "Une fois par mois"], answer: "Tous les jours" },
            { question: "Que faut-il faire si un produit a dépassé sa date limite ?", options: ["Noter et conserver", "Noter et jeter immédiatement", "Changer étiquette", "Le congeler"], answer: "Noter et jeter immédiatement" },
            { question: "Quelle procédure pour éviter la contamination croisée ?", options: ["Même matériel pour tous", "Manipuler séparément crus et cuits", "Laver mains toutes heures", "Mélanger produits"], answer: "Manipuler séparément crus et cuits" },
            { question: "Quelle taille O'tacos peut être vendue en version sucrée ?", options: ["M", "L", "XL", "O'mignon"], answer: "O'mignon" },
            { question: "Comment stocker les suppléments congelés ?", options: ["Température ambiante", "Au froid positif", "Au froid négatif", "Sur étagères"], answer: "Au froid négatif" },
            { question: "Critère primordial lors du choix d'un fournisseur ?", options: ["Prix produits", "Proximité", "Référencement O'Tacos", "Disponibilité immédiate"], answer: "Référencement O'Tacos" },
            { question: "Règle concernant les téléphones portables en cuisine ?", options: ["Autorisés si propres", "Rangés zone spécifique", "Que pendant pauses", "Strictement interdits"], answer: "Strictement interdits" },
            { question: "Comment traiter la zone propre ?", options: ["Stockage temporaire", "Zone sale jusqu'au nettoyage", "Zone à ne pas franchir par produits sales", "Entreposage déchets"], answer: "Zone à ne pas franchir par produits sales" },
            { question: "Temps d'attente avant mesurer qualité huile après cuisson ?", options: ["Immédiatement", "1 minute", "5 minutes", "10 minutes"], answer: "5 minutes" },
            { question: "Quantité de combinaisons possibles de O'Tacos ?", options: ["100000", "80000", "50000", "20000"], answer: "80000" },
            { question: "Comment conserver la sauce fromagère préparée ?", options: ["Température ambiante", "Froid négatif", "Étuve maintien chaud", "Congélateur"], answer: "Étuve maintien chaud" },
            { question: "Que faire en cas de panne d'électricité ?", options: ["Continuer servir", "Fermer temporairement", "Appeler technicien continuer", "Utiliser générateurs"], answer: "Fermer temporairement" },
            { question: "Quelles viandes sont cuites au four ?", options: ["Cordons bleus et nuggets", "Viande hachée et poulet", "Poulet pané et frites", "Merguez et jalapeños"], answer: "Viande hachée et poulet" },
            { question: "Procédure pour le nettoyage des surfaces en cuisine ?", options: ["Eau froide", "Torchons réutilisables", "Suivre plan nettoyage défini", "Éponge chaque surface"], answer: "Suivre plan nettoyage défini" },
            { question: "Temps d'attente maximum client avant recevoir O'tacos ?", options: ["2 minutes", "4 minutes", "6 minutes", "8 minutes"], answer: "4 minutes" },
            { question: "Température minimale lors de la cuisson des viandes ?", options: ["50°C", "60°C", "65°C", "70°C"], answer: "65°C" },
            { question: "Que signifie marche en avant ?", options: ["Suivre instructions client", "Séparer crus et cuits", "Organiser flux du propre vers le sale", "Manipuler avec précaution"], answer: "Organiser flux du propre vers le sale" },
            { question: "Combien de tailles de O'Tacos disponibles ?", options: ["3 tailles", "4 tailles", "5 tailles", "6 tailles"], answer: "5 tailles" },
            { question: "Boisson non incluse dans les menus ?", options: ["Coca-Cola", "Fanta", "Jus de pomme", "O'Shake"], answer: "Jus de pomme" },
            { question: "Première étape du système HACCP ?", options: ["Fixer seuil danger", "Créer dossier", "Analyser dangers existants", "Contrôler température"], answer: "Analyser dangers existants" },
            { question: "Durée maximale viandes cuites dans étuve ?", options: ["1 heure", "2 heures", "4 heures", "6 heures"], answer: "2 heures" },
            { question: "Appareil pour vérifier température produits surgelés ?", options: ["Thermomètre dilatation", "Thermomètre à sonde", "Testo 270", "Chronomètre"], answer: "Thermomètre à sonde" },
            { question: "Zone du restaurant considérée comme propre ?", options: ["Comptoir", "Réserve", "Cuisine", "Toilettes"], answer: "Cuisine" },
            { question: "Réaction si température produit non conforme ?", options: ["Continuer cuisson", "Noter erreur", "Actions correctives immédiatement", "Ne pas tenir compte"], answer: "Actions correctives immédiatement" },
            { question: "Durée maximale conservation frites après cuisson ?", options: ["10 minutes", "20 minutes", "30 minutes", "40 minutes"], answer: "30 minutes" },
            { question: "Comment préparer la sauce fromagère ?", options: ["Mélangée à froid", "Réchauffée dans étuve", "Cuite friteuse", "Servie température ambiante"], answer: "Réchauffée dans étuve" },
            { question: "Ingrédients jamais utilisés dans O'tacos sucré ?", options: ["Sauce chocolat", "Viande hachée", "Fruits", "Sauce caramel"], answer: "Viande hachée" },
            { question: "Que faire si problème hygiène observé ?", options: ["Ignorer", "Signaler manager immédiatement", "Attendre fin journée", "Corriger seul"], answer: "Signaler manager immédiatement" }
        ];

        const restaurants = ['Louvain-La-Neuve', 'Auderghem', 'Uccle', 'Halle', 'Soignies', 'Ath', 'Renaix', 'Mouscron'];

        let state = {
            view: 'home',
            employeeName: '',
            restaurant: '',
            quizSize: 10,
            currentQuiz: [],
            currentQuestion: 0,
            answers: [],
            history: JSON.parse(localStorage.getItem('otacos-history') || '[]')
        };

        function render() {
            const app = document.getElementById('app');
            if (state.view === 'home') app.innerHTML = renderHome();
            else if (state.view === 'quiz') app.innerHTML = renderQuiz();
            else if (state.view === 'results') app.innerHTML = renderResults();
            else if (state.view === 'history') app.innerHTML = renderHistory();
        }

        function renderHome() {
            return `
                <div class="card">
                    <h1>🌮 Quiz O'Tacos</h1>
                    <p class="subtitle">Groupe AMAUH - Contrôle des connaissances terrain</p>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Nom de l'équipier</label>
                            <input type="text" id="employeeName" placeholder="Prénom Nom" value="${state.employeeName}">
                        </div>
                        <div class="form-group">
                            <label>Restaurant</label>
                            <select id="restaurant">
                                <option value="">Sélectionner...</option>
                                ${restaurants.map(r => `<option value="${r}" ${state.restaurant === r ? 'selected' : ''}>${r}</option>`).join('')}
                            </select>
                        </div>
                    </div>

                    <div class="quiz-size">
                        <label>Nombre de questions pour le quiz</label>
                        <div class="size-options">
                            ${[5, 10, 15, 20].map(size => `
                                <button class="size-btn ${state.quizSize === size ? 'active' : ''}" onclick="setQuizSize(${size})">${size}</button>
                            `).join('')}
                        </div>
                        <p class="text-small" style="margin-top: 10px;">Banque actuelle : ${questions.length} questions</p>
                    </div>

                    <button class="btn btn-primary" onclick="startQuiz()">🎲 Générer un Quiz Aléatoire</button>
                </div>

                <div class="grid">
                    <div class="icon-card" onclick="state.view='history'; render();">
                        <div class="icon">📊</div>
                        <h3>Historique</h3>
                        <p class="text-small">${state.history.length} quiz réalisés</p>
                    </div>
                    <div class="icon-card" onclick="exportData()">
                        <div class="icon">💾</div>
                        <h3>Sauvegarder</h3>
                        <p class="text-small">Export JSON</p>
                    </div>
                </div>
            `;
        }

        function renderQuiz() {
            const q = state.currentQuiz[state.currentQuestion];
            const progress = ((state.currentQuestion + 1) / state.currentQuiz.length) * 100;
            
            return `
                <div class="card">
                    <div class="flex-between" style="margin-bottom: 15px;">
                        <span style="font-weight: 600; color: #6b7280;">Question ${state.currentQuestion + 1} / ${state.currentQuiz.length}</span>
                        <span style="font-weight: 600; color: #f97316;">${state.employeeName}</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                    
                    <h2>${q.question}</h2>
                    
                    <div>
                        ${q.options.map((opt, idx) => `
                            <button class="option-btn" onclick="answerQuestion('${opt.replace(/'/g, "\\'")}')">
                                <span class="option-letter">${String.fromCharCode(65 + idx)}</span>
                                ${opt}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderResults() {
            const r = state.results;
            const icon = r.percentage >= 80 ? '✅' : r.percentage >= 60 ? '⚠️' : '❌';
            
            return `
                <div class="card">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <div style="font-size: 5em; margin-bottom: 20px;">${icon}</div>
                        <h1 style="margin-bottom: 10px;">Résultats du Quiz</h1>
                        <p style="color: #6b7280; font-size: 1.1em;">${r.employeeName} - ${r.restaurant}</p>
                        <p class="text-small">${r.date}</p>
                    </div>

                    <div class="score-display">
                        <div class="score-number">${r.percentage}%</div>
                        <div style="font-size: 1.3em;">${r.score} / ${r.total} bonnes réponses</div>
                    </div>

                    <div style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                        ${r.details.map(d => `
                            <div class="result-card ${d.isCorrect ? 'correct' : 'wrong'}">
                                <div style="display: flex; gap: 15px;">
                                    <div style="font-size: 1.5em;">${d.isCorrect ? '✅' : '❌'}</div>
                                    <div style="flex: 1;">
                                        <p style="font-weight: 600; margin-bottom: 8px;">${d.question}</p>
                                        <p class="text-small">Réponse donnée : ${d.userAnswer}</p>
                                        ${!d.isCorrect ? `<p class="text-success" style="margin-top: 5px;">Bonne réponse : ${d.correctAnswer}</p>` : ''}
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="grid">
                        <button class="btn btn-primary" onclick="resetQuiz()">Nouveau Quiz</button>
                        <button class="btn btn-secondary" onclick="state.view='history'; render();">Voir l'Historique</button>
                    </div>
                </div>
            `;
        }

        function renderHistory() {
            return `
                <div class="card">
                    <div class="flex-between" style="margin-bottom: 20px;">
                        <h2>Historique des Quiz (${state.history.length})</h2>
                        <button class="btn btn-secondary btn-small" onclick="state.view='home'; render();">Retour</button>
                    </div>

                    ${state.history.length === 0 ? 
                        '<p style="text-align: center; color: #6b7280; padding: 40px;">Aucun quiz réalisé</p>' :
                        state.history.map(h => `
                            <div class="question-item">
                                <div class="flex-between">
                                    <div>
                                        <h3>${h.employeeName}</h3>
                                        <p class="text-small">${h.restaurant} - ${h.date}</p>
                                        <p class="text-small" style="margin-top: 5px;">${h.score} / ${h.total} réponses correctes</p>
                                    </div>
                                    <div style="font-size: 2em; font-weight: bold; color: ${h.percentage >= 80 ? '#10b981' : h.percentage >= 60 ? '#f59e0b' : '#ef4444'};">
                                        ${h.percentage}%
                                    </div>
                                </div>
                            </div>
                        `).join('')
                    }
                </div>
            `;
        }

        function setQuizSize(size) {
            state.quizSize = size;
            render();
        }

        function startQuiz() {
            state.employeeName = document.getElementById('employeeName').value;
            state.restaurant = document.getElementById('restaurant').value;

            if (!state.employeeName || !state.restaurant) {
                alert('Veuillez renseigner le nom et le restaurant');
                return;
            }

            const shuffled = [...questions].sort(() => Math.random() - 0.5);
            state.currentQuiz = shuffled.slice(0, state.quizSize);
            state.currentQuestion = 0;
            state.answers = [];
            state.view = 'quiz';
            render();
        }

        function answerQuestion(answer) {
            state.answers.push(answer);
            
            if (state.currentQuestion < state.currentQuiz.length - 1) {
                state.currentQuestion++;
                render();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            const score = state.answers.filter((ans, idx) => ans === state.currentQuiz[idx].answer).length;
            const percentage = Math.round((score / state.currentQuiz.length) * 100);
            
            state.results = {
                employeeName: state.employeeName,
                restaurant: state.restaurant,
                date: new Date().toLocaleString('fr-BE'),
                score,
                total: state.currentQuiz.length,
                percentage,
                details: state.currentQuiz.map((q, idx) => ({
                    question: q.question,
                    userAnswer: state.answers[idx],
                    correctAnswer: q.answer,
                    isCorrect: state.answers[idx] === q.answer
                }))
            };
            
            state.history.unshift(state.results);
            localStorage.setItem('otacos-history', JSON.stringify(state.history));
            state.view = 'results';
            render();
        }

        function resetQuiz() {
            state.view = 'home';
            state.employeeName = '';
            state.restaurant = '';
            render();
        }

        function exportData() {
            const data = { questions, history: state.history };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'otacos-quiz-backup.json';
            a.click();
        }

        render();
    </script>
</body>
</html>
